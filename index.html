<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="windows-1252">  
  <title>CRM Demo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="css/style.css" />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  
<style>
body {
	margin:0;
	padding:0
}

#header, #footer {
	width: 100%;
	text-align: center;
	color: #efefef;
	background-color: #111111;
}

#header {
	position: fixed;
	top: 0;
}

#footer {
	position: fixed;
	bottom: 0;
}

</style>

<script>
var g = null;

$(document).ready(function(){
	refreshContacts();
	refreshOrganizations();	
});

function showError(strError) {
	alert(strError);
	return;
}

function refreshContacts() {

	$.ajax({
		url: "api/index.php?action=fetch_contacts", 
		success: function(result){
			refreshContacts_callback(result);
		}
	});

	return;
}

function refreshContacts_callback(data) {

	var objResponse = JSON.parse(data);
	
	if (objResponse['successful'] && 'false' == objResponse['successful']) {
		showError(objResponse['message']);
	}
	else {
		displayContacts(objResponse['contacts']);	
	}
	
	return;
}

function displayContacts(arrContacts) {

	var strHTML = '';
	
	for (var x in arrContacts) {

		var iID = arrContacts[x]['id'];	
		var strFirstname = arrContacts[x]['firstname'];
		var strLastname = arrContacts[x]['lastname'];
		var strEmail = arrContacts[x]['email'];
		var strPhone = arrContacts[x]['phone'];

		strHTML += '<form> \
					<span>'+iID+'</span> \
					<input name="firstname" type="text" value="'+strFirstname+'" required="required" /> \
					<input name="lastname" type="text" value="'+strLastname+'" required="required" /> \
					<input name="email" type="email" value="'+strEmail+'" required="required" /> \
					<input name="phone" type="tel" value="'+strPhone+'" required="required" /> \
					<button>Edit</button> \
					<button>Del</button> \
					</form> \
					';
					
	}
	
	var objContactDiv = document.getElementById('contactArea');
	objContactDiv.innerHTML = strHTML;
	
	return;
}

function refreshOrganizations() {
	$.ajax({
		url: "api/index.php?action=fetch_organizations", 
		success: function(result){
			refreshOrganizations_callback(result);
		}
	});
}

function refreshOrganizations_callback(data) {

	var objResponse = JSON.parse(data);
	
	if (objResponse['successful'] && 'false' == objResponse['successful']) {
		showError(objResponse['message']);
	}
	else {
		displayOrganizations(objResponse['organizations']);	
	}
	
	return;
}

function displayOrganizations(arrContacts) {

	var strHTML = '';
	
	for (var x in arrContacts) {

		var iID = arrContacts[x]['id'];	
		var strOrgName = arrContacts[x]['org_name'];
		var strWebsite = arrContacts[x]['website'];

		strHTML += '<form> \
					<span>'+iID+'</span> \
					<input name="org_name" type="text" value="'+strOrgName+'" required="required" /> \
					<input name="website" type="text" value="'+strWebsite+'" required="required" /> \
					<button>Edit</button> \
					<button>Del</button> \
					</form> \
					';
					
	}
	
	var objOrgDiv = document.getElementById('organizationArea');
	objOrgDiv.innerHTML = strHTML;
	
	return;
}

</script>
  
  
</head>
<body>

<div id="header">
CRM Demo
</div>

<div id="content">

<br /><br />

<h2>Contacts</h2>

<div id="contactArea"></div>

<h2>Organizations</h2>

<div id="organizationArea"></div>


</div>

<div id="footer">
&copy; 2015-Present by Kevin Meixner
</div>


</body>
</html>